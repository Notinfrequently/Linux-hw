# Homework Linux №3

## Задание:
1. Создание и контроль доступа групе пользователей.
    - [x] Создать нескольких пользователей, задать им пароли, домашние директории и шеллы;
    - [x] Создать группу admin;
    - [x] Включить нескольких из ранее созданных пользователей, а также пользователя root, в группу admin;
    - [x] Запретить всем пользователям, кроме группы admin, логин в систему по SSH в выходные дни (суббота и воскресенье, без учета праздников).
    - [ ] (Optional) С учётом праздничных дней.
    (Для упрощения проверки можно разрешить парольную аутентификацию по SSH и использовать ssh user@localhost проверяя логин с этой же машины)

2. Установить docker; дать конкретному пользователю:
    - [x] права работать с docker (выполнять команды docker ps и т.п.);
    - [ ] (Optional) возможность перезапускать демон docker (systemctl restart docker) не выдавая прав более, чем для этого нужно;

Выполнение:
1. Подготовим среду для работы.
```
    vagrant init hashicorp/bionic64
    vagrant up
    vagrant ssh
```
2. Дбоавим новых пользователей:

    `sudo useradd <имя> -m -p <пароль> -s /bin/bash`

    где, -m создаст домашнюю директорию с именем пользователя

    -p задаст пароль пользователю

    -s задаст стандартный шел

3. Создадим группу admin и добавим туда root и одного пользователя:

    `sudo groupadd admin`

    `sudo usermod -a -G admin root`

    `sudo usermod -a -G admin <имя_пользователя>`

4. Ограничим доступ по ssh всем пользователям кроме группы admin в выходные

    Добавим строку `account requierd pam_time.so` в файл `/etc/pam.d/sshd`

    Так мы включим в процесс аутентификации модуль time.

    Теперь добавим правило:

    Добавим в `/etc/security/time.conf` строку `sshd;*;!admin;Wk0000-2400`

    - первый аргумент запрещает соединение по ssh

    - второй определяет терминалы к которым относится правило

    - третий аргумент диктует к кому применить правило, в данно случае ко всем кроме группы `admin`

    - четвертый обозначает временной промежуток Wk - выходные, 0000-2400 - часы

5. Установить докер и выдать его под контроль одному пользователю.

    `sudo apt install docker.io` (для Ubuntu)

    Для того что бы конкретный пользователь мог ползоваться Docker необходимо поменять права владения исполняемым файлом.

    `sudo chmod 750 /usr/bin/*docker*`  отберем права на использования

    `sudo setfacl u:<имя пользователя>:rx *docker*`  добавим ACL правило на исполнение и чтение пользователю





            